(function(b){b.fn.lightBox=function(a){function p(){b("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-image-box"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-btnPrev"></a><a href="#" id="lightbox-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+a.imageLoading+'"></a></div></div><div id="lightbox-image-data-box"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-number"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-btnClose"><img src="'+a.imageBtnClose+'"></a></div></div></div>');var c=l();b("#jquery-overlay").css({backgroundColor:a.overlayBgColor,opacity:a.overlayOpacity,width:c[0],height:c[1]}).fadeIn();var g=m();b("#jquery-lightbox").css({top:g[1]+c[3]/15,left:g[0]}).show();b("#jquery-overlay,#jquery-lightbox").click(function(){k()});b("#lightbox-loading-link,#lightbox-btnClose").click(function(){k();return!1});b(window).resize(function(){var a=l();b("#jquery-overlay").css({width:a[0],height:a[1]});var c=m();b("#jquery-lightbox").css({top:c[1]+a[3]/10,left:c[0]})})}function f(){b("#lightbox-loading").show();a.fixedNavigation?b("#lightbox-image,#lightbox-image-data-box,#lightbox-image-details-number").hide():b("#lightbox-image,#lightbox-nav,#lightbox-btnPrev,#lightbox-btnNext,#lightbox-image-data-box,#lightbox-image-details-number").hide();var c=new Image,g=document.documentElement.clientWidth,e=document.documentElement.clientHeight;c.onload=function(){b("#lightbox-image").attr("src",a.imageArray[a.activeImage][0]);var d=c.width,f=c.height;d<g&&f<e&&b("#lightbox-image").attr({width:c.width,height:c.height});d>=g&&(d=.8*g,b("#lightbox-image").attr({width:d,height:"auto"}),f=b("#lightbox-image").height());f>=e&&(f=.8*e,b("#lightbox-image").attr({width:"auto",height:f}),d=b("#lightbox-image").width());q(d,f);c.onload=function(){}};c.src=a.imageArray[a.activeImage][0]}function q(c,g){var e=b("#lightbox-image-box").width(),d=b("#lightbox-image-box").height(),e=e-c,d=d-g;b("#lightbox-image-box").animate({width:c,height:g},a.containerResizeSpeed,function(){r()});0==e&&0==d&&(b.browser.msie?n(250):n(100));b("#lightbox-image-data-box").css({width:c});b("#lightbox-btnPrev,#lightbox-btnNext").css({height:g})}function r(){b("#lightbox-loading").hide();b("#lightbox-image").fadeIn(function(){b("#lightbox-image-data-box").slideDown("fast");b("#lightbox-image-details-caption").hide();a.imageArray[a.activeImage][1]&&b("#lightbox-image-details-caption").html(a.imageArray[a.activeImage][1]).show();1<a.imageArray.length&&b("#lightbox-image-details-number").html(a.txtImage+" "+(a.activeImage+1)+" "+a.txtOf+" "+a.imageArray.length).show();t()});a.imageArray.length-1>a.activeImage&&(objNext=new Image,objNext.src=a.imageArray[a.activeImage+1][0]);0<a.activeImage&&(objPrev=new Image,objPrev.src=a.imageArray[a.activeImage-1][0])}function t(){b("#lightbox-nav").show();b("#lightbox-btnPrev,#lightbox-btnNext").css({background:"transparent url("+a.imageBlank+") no-repeat"});0!=a.activeImage?a.fixedNavigation?b("#lightbox-btnPrev").css({background:"url("+a.imageBtnPrev+") left 40% no-repeat"}).unbind().bind("click",function(){--a.activeImage;f();return!1}):b("#lightbox-btnPrev").unbind().hover(function(){b(this).css({background:"url("+a.imageBtnPrev+") left 40% no-repeat"})},function(){b(this).css({background:"transparent url("+a.imageBlank+") no-repeat"})}).show().bind("click",function(){--a.activeImage;f();return!1}):b("#lightbox-btnPrev").css({height:"0"});a.activeImage!=a.imageArray.length-1?a.fixedNavigation?b("#lightbox-btnNext").css({background:"url("+a.imageBtnNext+") right 40% no-repeat"}).unbind().bind("click",function(){a.activeImage+=1;f();return!1}):b("#lightbox-btnNext").unbind().hover(function(){b(this).css({background:"url("+a.imageBtnNext+") right 40% no-repeat"})},function(){b(this).css({background:"transparent url("+a.imageBlank+") no-repeat"})}).show().bind("click",function(){a.activeImage+=1;f();return!1}):b("#lightbox-btnNext").css({height:"0"});u()}function u(){b(document).keydown(function(c){null==c?(keycode=event.keyCode,escapeKey=27):(keycode=c.keyCode,escapeKey=c.DOM_VK_ESCAPE);key=String.fromCharCode(keycode).toLowerCase();key!=a.keyToClose&&27!=keycode&&keycode!=escapeKey||k();key!=a.keyToPrev&&37!=keycode||0==a.activeImage||(--a.activeImage,f(),b(document).unbind());key!=a.keyToNext&&39!=keycode||a.activeImage==a.imageArray.length-1||(a.activeImage+=1,f(),b(document).unbind())})}function k(){b("#jquery-lightbox").remove();b("#jquery-overlay").fadeOut(function(){b("#jquery-overlay").remove()});b("embed, object, select").css({visibility:"visible"})}function l(){var a,b;window.innerHeight&&window.scrollMaxY?(a=window.innerWidth+window.scrollMaxX,b=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(a=document.body.scrollWidth,b=document.body.scrollHeight):(a=document.body.offsetWidth,b=document.body.offsetHeight);var e,d;self.innerHeight?(e=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,d=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,d=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,d=document.body.clientHeight);pageHeight=b<d?d:b;pageWidth=a<e?a:e;return arrayPageSize=[pageWidth,pageHeight,e,d]}function m(){var a,b;self.pageYOffset?(b=self.pageYOffset,a=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(b=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):document.body&&(b=document.body.scrollTop,a=document.body.scrollLeft);return arrayPageScroll=[a,b]}function n(a){var b=new Date;do var c=new Date;while(c-b<a)}a=jQuery.extend({disableNavigation:!1,overlayBgColor:"#000",overlayOpacity:.6,fixedNavigation:!0,imageLoading:"images/lightbox-loading.gif",imageBtnPrev:"images/lightbox-prev.png",imageBtnNext:"images/lightbox-next.png",imageBtnClose:"images/lightbox-close.png",imageBlank:"images/lightbox-blank.gif",containerResizeSpeed:400,containerBorderSize:0,txtImage:"Image",txtOf:"/",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},a);var h=this;return this.unbind("click").click(function(){b("embed, object, select").css({visibility:"hidden"});p();a.imageArray.length=0;a.activeImage=0;numberOfImages=h.length;a.disableNavigation&&(numberOfImages=1);if(1==numberOfImages)a.imageArray.push([this.getAttribute("href"),this.getAttribute("title")]);else for(var c=0;c<h.length;c++)a.imageArray.push([h[c].getAttribute("href"),h[c].getAttribute("title")]);for(;a.imageArray[a.activeImage][0]!=this.getAttribute("href");)a.activeImage++;f();return!1})}})(jQuery);